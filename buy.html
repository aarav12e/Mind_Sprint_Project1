<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Buy / Order ‚Äî Mind Sprint</title>
  <link rel="stylesheet" href="style.css">
  <style>
    main { max-width:900px; margin:40px auto; padding:20px; background:#fff; border-radius:10px; box-shadow:0 8px 30px rgba(0,0,0,0.06); }
    h1{ color:#16a34a; margin-bottom:8px }
    section{ margin:18px 0; padding:12px; border-radius:8px; background:#f9fafb; }
    label{ display:block; margin:8px 0 4px; font-weight:600 }
    input[type="text"], input[type="tel"], input[type="number"], textarea, select { width:100%; padding:10px; border-radius:6px; border:1px solid #ddd }
    .row{ display:flex; gap:12px; }
    .col{ flex:1 }
    .small { max-width:220px }
    .btn { padding:10px 14px; border-radius:8px; border:none; cursor:pointer; font-weight:700 }
    .btn-primary{ background:#16a34a; color:#fff }
    .btn-ghost{ background:#fff; border:1px solid #16a34a; color:#16a34a }
    .badge{ display:inline-block; background:#e6ffed; color:#087f5b; padding:6px 8px; border-radius:6px; font-weight:700 }
    .label-preview{ background:#fff; border:1px dashed #ddd; padding:10px; margin-top:8px; border-radius:6px }
    .timeline{ display:flex; gap:8px; align-items:center; margin-top:8px }
    .step{ padding:8px 10px; border-radius:8px; background:#fff; border:1px solid #eee; font-weight:700 }
    .step.active{ background:#16a34a; color:#fff }
    .note{ color:#555; font-size:14px; margin-top:8px }
  </style>
</head>
<body>
  <nav>
    <h1 style="color:white; position:relative; left:20px;">Mind Sprint ‚Äî Order</h1>
  </nav>
  <main>
    <h1>Create Order & Shipping Label</h1>
    <p class="note">Fill mandatory fields (Name, Mobile, Address, Pincode, Product name, Quantity, Price). Without these delivery cannot be processed.</p>

    <!-- 1Ô∏è‚É£ Customer Details -->
    <section id="customer-details">
      <h3>1Ô∏è‚É£ Customer Details (Mandatory)</h3>
      <label for="cust-name">Customer ka naam *</label>
      <input id="cust-name" type="text" required placeholder="Full name">

      <div class="row">
        <div class="col small">
          <label for="cust-mobile">Mobile number *</label>
          <input id="cust-mobile" type="tel" pattern="[0-9]{10}" required placeholder="9876543210">
        </div>
        <div class="col small">
          <label for="cust-pincode">Pincode *</label>
          <input id="cust-pincode" type="text" pattern="[0-9]{6}" required placeholder="110001">
        </div>
      </div>

      <label for="cust-address">Delivery address *</label>
      <textarea id="cust-address" rows="3" required placeholder="House no, Street, Area"></textarea>

      <label for="cust-landmark">Landmark (optional)</label>
      <input id="cust-landmark" type="text" placeholder="Near temple / Mall">
    </section>

    <!-- 2Ô∏è‚É£ Order Details -->
    <section id="order-details">
      <h3>2Ô∏è‚É£ Order Details</h3>
      <label for="product-name">Product ka naam *</label>
      <input id="product-name" type="text" required placeholder="e.g. Curvy Bananas">

      <div class="row">
        <div class="col small">
          <label for="quantity">Quantity *</label>
          <input id="quantity" type="number" min="1" value="1" required>
        </div>
        <div class="col small">
          <label for="price">Price (‚Çπ) *</label>
          <input id="price" type="number" min="0" step="0.01" required>
        </div>
        <div class="col small">
          <label for="order-id">Order ID</label>
          <input id="order-id" type="text" readonly placeholder="(will be generated)">
        </div>
      </div>

      <label for="payment-mode">Payment Mode</label>
      <select id="payment-mode">
        <option value="prepaid">Prepaid (Online)</option>
        <option value="cod">Cash on Delivery (COD)</option>
      </select>

      <p class="note">Delivery boy ko batata hai kya deliver karna hai.</p>
    </section>

    <!-- 3Ô∏è‚É£ Proper Packaging -->
    <section id="packaging">
      <h3>3Ô∏è‚É£ Proper Packaging</h3>
      <label><input type="checkbox" id="pack-bubble"> Safe packing (bubble wrap / box)</label>
      <label><input type="checkbox" id="pack-damage"> Product damage-proof</label>
      <label><input type="checkbox" id="pack-tape"> Tape and sealing</label>
      <label><input type="checkbox" id="pack-label"> Shipping label attached</label>
      <p class="note">Taaki product safe rahe aur identify ho sake.</p>
    </section>

    <!-- 4Ô∏è‚É£ Shipping Label -->
    <section id="shipping-label">
      <h3>4Ô∏è‚É£ Shipping Label (Preview)</h3>
      <div class="label-preview" id="label-preview">
        <div><strong>Customer:</strong> <span id="lbl-name">-</span></div>
        <div><strong>Address:</strong> <span id="lbl-address">-</span> <strong>Pincode:</strong> <span id="lbl-pincode">-</span></div>
        <div><strong>Phone:</strong> <span id="lbl-phone">-</span></div>
        <div><strong>Order ID:</strong> <span id="lbl-order">-</span></div>
        <div><strong>Tracking ID:</strong> <span id="lbl-track">-</span></div>
      </div>
      <p class="note">Ye label packet ke upar chipka hona chahiye.</p>
    </section>

    <!-- 5Ô∏è‚É£ Delivery Partner -->
    <section>
      <h3>5Ô∏è‚É£ Delivery Partner / Courier Service</h3>
      <select id="courier">
        <option value="delhivery">Delhivery</option>
        <option value="bluedart">Blue Dart</option>
        <option value="dtdc">DTDC</option>
        <option value="ekart">Ekart (Flipkart)</option>
        <option value="shadowfax">Shadowfax</option>
      </select>
      <p class="note">Unke app me order update hota hai.</p>
    </section>

    <!-- 6Ô∏è‚É£ Delivery Boy / Agent -->
    <section>
      <h3>6Ô∏è‚É£ Delivery Boy / Agent</h3>
      <label for="agent-name">Agent Name</label>
      <input id="agent-name" type="text" placeholder="Agent full name">

      <label for="agent-id">Agent ID</label>
      <input id="agent-id" type="text" placeholder="ID / Employee no">

      <div class="row">
        <div class="col small">
          <label><input type="checkbox" id="agent-smartphone"> Smartphone</label>
        </div>
        <div class="col small">
          <label><input type="checkbox" id="agent-app"> Courier App installed</label>
        </div>
        <div class="col small">
          <label><input type="checkbox" id="agent-gps"> GPS navigation</label>
        </div>
      </div>
      <label for="agent-vehicle">Vehicle</label>
      <input id="agent-vehicle" type="text" placeholder="Bike / Scooter / Van">
    </section>

    <!-- 7Ô∏è‚É£ Payment Mode note is in Order Details -->

    <!-- 8Ô∏è‚É£ Tracking System -->
    <section>
      <h3>8Ô∏è‚É£ Tracking System</h3>
      <div class="timeline" id="tracking-timeline">
        <div class="step" data-step="picked">Order picked</div>
        <div class="step" data-step="transit">In transit</div>
        <div class="step" data-step="out">Out for delivery</div>
        <div class="step" data-step="delivered">Delivered</div>
      </div>
      <div style="margin-top:10px; display:flex; gap:8px;">
        <button class="btn btn-ghost" onclick="setTracking('picked')">Mark picked</button>
        <button class="btn btn-ghost" onclick="setTracking('transit')">Mark in transit</button>
        <button class="btn btn-ghost" onclick="setTracking('out')">Mark out for delivery</button>
        <button class="btn btn-primary" onclick="setTracking('delivered')">Mark delivered</button>
      </div>
    </section>

    <!-- 9Ô∏è‚É£ OTP or Signature -->
    <section>
      <h3>9Ô∏è‚É£ OTP or Signature (For Verification)</h3>
      <div style="display:flex; gap:8px; align-items:center;">
        <button class="btn btn-primary" onclick="sendOTP()">Send OTP</button>
        <input id="otp-input" type="text" placeholder="Enter OTP" style="width:160px; padding:8px; border-radius:6px; border:1px solid #ddd">
        <button class="btn btn-ghost" onclick="verifyOTP()">Verify OTP</button>
      </div>
      <p class="note">OTP will be sent to customer phone (simulated). Or capture signature below.</p>
      <label for="signature">Signature (customer)</label>
      <input id="signature" type="text" placeholder="Customer typed name as signature">
    </section>

    <!-- 10Ô∏è‚É£ Return / Replacement Policy -->
    <section>
      <h3>üîü Return / Replacement Policy</h3>
      <p>Return pickup, Exchange, and Refund process are supported. Use buttons below to simulate.</p>
      <div style="display:flex; gap:8px;">
        <button class="btn btn-ghost" onclick="initiateReturn('return')">Initiate Return</button>
        <button class="btn btn-ghost" onclick="initiateReturn('exchange')">Initiate Exchange</button>
        <button class="btn btn-ghost" onclick="initiateReturn('refund')">Request Refund</button>
      </div>
    </section>

    <div style="margin-top:16px; display:flex; gap:8px;">
      <button class="btn btn-primary" onclick="generateOrder()">Generate Order & Label</button>
      <button class="btn btn-ghost" onclick="saveAsDraft()">Save as Draft</button>
      <button class="btn" style="background:#ef4444; color:#fff" onclick="clearForm()">Clear Form</button>
    </div>

    <p style="margin-top:14px; color:#555; font-size:14px">Note: This page simulates order creation and label generation. In production, SMS OTP and courier integration would be done server-side.</p>
  </main>

  <script>
    // Simple in-page state
    let currentOTP = null;
    let currentStatus = null;

    function generateId(prefix){
      return prefix + '-' + Math.random().toString(36).substr(2,9).toUpperCase();
    }

    function validateMandatory(){
      const name = document.getElementById('cust-name').value.trim();
      const mobile = document.getElementById('cust-mobile').value.trim();
      const pincode = document.getElementById('cust-pincode').value.trim();
      const address = document.getElementById('cust-address').value.trim();
      const product = document.getElementById('product-name').value.trim();
      const qty = document.getElementById('quantity').value;
      const price = document.getElementById('price').value;

      if(!name || !mobile || !pincode || !address || !product || !qty || !price){
        alert('Please fill all mandatory fields (Name, Mobile, Address, Pincode, Product, Quantity, Price).');
        return false;
      }
      if(!/^[0-9]{10}$/.test(mobile)) { alert('Enter valid 10 digit mobile number'); return false; }
      if(!/^[0-9]{6}$/.test(pincode)) { alert('Enter valid 6 digit pincode'); return false; }
      return true;
    }

    function generateOrder(){
      if(!validateMandatory()) return;

      const orderId = generateId('ORD');
      const trackingId = generateId('TRK');
      document.getElementById('order-id').value = orderId;

      // Update shipping label preview
      document.getElementById('lbl-name').innerText = document.getElementById('cust-name').value;
      const address = document.getElementById('cust-address').value + (document.getElementById('cust-landmark').value ? ', Landmark: ' + document.getElementById('cust-landmark').value : '');
      document.getElementById('lbl-address').innerText = address;
      document.getElementById('lbl-pincode').innerText = document.getElementById('cust-pincode').value;
      document.getElementById('lbl-phone').innerText = document.getElementById('cust-mobile').value;
      document.getElementById('lbl-order').innerText = orderId;
      document.getElementById('lbl-track').innerText = trackingId;

      // Save a small order object locally
      const order = {
        orderId, trackingId,
        customer: {
          name: document.getElementById('cust-name').value,
          phone: document.getElementById('cust-mobile').value,
          address: document.getElementById('cust-address').value,
          pincode: document.getElementById('cust-pincode').value,
          landmark: document.getElementById('cust-landmark').value
        },
        product: {
          name: document.getElementById('product-name').value,
          qty: document.getElementById('quantity').value,
          price: document.getElementById('price').value,
        },
        courier: document.getElementById('courier').value,
        payment: document.getElementById('payment-mode').value,
        packaging: {
          bubble: document.getElementById('pack-bubble').checked,
          damage: document.getElementById('pack-damage').checked,
          tape: document.getElementById('pack-tape').checked,
          label: document.getElementById('pack-label').checked
        },
        status: 'Order picked'
      }

      // store in localStorage for demo
      localStorage.setItem('latestOrder', JSON.stringify(order));

      // mark timeline to 'picked'
      setTracking('picked');

      alert('Order generated: ' + orderId + '\nTracking: '+ trackingId);
    }

    function setTracking(step){
      currentStatus = step;
      const steps = document.querySelectorAll('.timeline .step');
      steps.forEach(s => s.classList.remove('active'));
      // mark up to the step as active
      const order = ['picked','transit','out','delivered'];
      const idx = order.indexOf(step);
      for(let i=0;i<=idx;i++){
        const s = document.querySelector('.timeline .step[data-step="'+order[i]+'"]');
        if(s) s.classList.add('active');
      }
      // show small note
      showToast('Status updated: ' + step);

      // update stored order
      const stored = JSON.parse(localStorage.getItem('latestOrder')||'null');
      if(stored){ stored.status = step; localStorage.setItem('latestOrder', JSON.stringify(stored)); }
    }

    function sendOTP(){
      if(!validateMandatory()) return;
      currentOTP = Math.floor(1000 + Math.random()*9000).toString();
      // In real system we'd send SMS. Here we simulate by alert and console.
      alert('Simulated OTP sent to customer: ' + currentOTP);
      console.log('Simulated OTP:', currentOTP);
    }

    function verifyOTP(){
      const val = document.getElementById('otp-input').value.trim();
      if(!currentOTP){ alert('Please send OTP first'); return; }
      if(val === currentOTP){
        showToast('OTP verified ‚Äî Delivery complete');
        setTracking('delivered');
        // store proof
        const stored = JSON.parse(localStorage.getItem('latestOrder')||'null');
        if(stored){ stored.proof = { type:'otp', value:val, time: new Date().toISOString() }; localStorage.setItem('latestOrder', JSON.stringify(stored)); }
      } else {
        alert('Invalid OTP');
      }
    }

    function initiateReturn(type){
      const stored = JSON.parse(localStorage.getItem('latestOrder')||'null');
      if(!stored){ alert('No order found to return/exchange'); return; }
      // Simulate a return request
      const req = { type, orderId: stored.orderId, createdAt: new Date().toISOString() };
      localStorage.setItem('returnRequest', JSON.stringify(req));
      alert('Request submitted: ' + type + '\nOur team will schedule pickup.');
    }

    function saveAsDraft(){
      const draft = {
        name: document.getElementById('cust-name').value,
        phone: document.getElementById('cust-mobile').value,
        product: document.getElementById('product-name').value
      };
      localStorage.setItem('orderDraft', JSON.stringify(draft));
      showToast('Saved as draft');
    }

    function clearForm(){
      if(!confirm('Clear the form?')) return;
      document.querySelectorAll('#customer-details input, #customer-details textarea, #order-details input, #order-details textarea, #order-details select').forEach(i=>i.value='');
      document.querySelectorAll('#packaging input').forEach(i=>i.checked=false);
      document.getElementById('label-preview').querySelectorAll('span').forEach(s=>s.innerText='-');
      document.getElementById('order-id').value='';
      showToast('Form cleared');
    }

    // Small reusable toast (keeps page consistent with app.js style)
    function showToast(msg){
      const toast = document.createElement('div');
      toast.className = 'toast';
      toast.innerText = msg;
      document.body.appendChild(toast);
      setTimeout(()=> toast.remove(),1500);
    }

    // If a product was selected via "Buy Now", prefill product fields
    document.addEventListener('DOMContentLoaded', function(){
      try{
        const bp = localStorage.getItem('buyProduct');
        if(bp){
          const p = JSON.parse(bp);
          if(p.name) document.getElementById('product-name').value = p.name;
          if(p.price !== undefined) document.getElementById('price').value = p.price;
          if(p.quantity !== undefined) document.getElementById('quantity').value = p.quantity;
          // Keep the buyProduct in storage until order is generated; user may edit qty/price
        }
      }catch(e){ console.error('Error reading buyProduct', e); }
    });

    // Remove buyProduct after order generation so it won't prefill future orders
    const origGenerateOrder = generateOrder;
    generateOrder = function(){
      origGenerateOrder();
      try{ localStorage.removeItem('buyProduct'); }catch(e){ }
    }
  </script>
</body>
</html>